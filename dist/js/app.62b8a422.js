(function(t){function e(e){for(var r,o,s=e[0],h=e[1],l=e[2],c=0,d=[];c<s.length;c++)o=s[c],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&d.push(a[o][0]),a[o]=0;for(r in h)Object.prototype.hasOwnProperty.call(h,r)&&(t[r]=h[r]);u&&u(e);while(d.length)d.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],r=!0,s=1;s<n.length;s++){var h=n[s];0!==a[h]&&(r=!1)}r&&(i.splice(e--,1),t=o(o.s=n[0]))}return t}var r={},a={app:0},i=[];function o(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=r,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],h=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var u=h;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},1937:function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("139b"),n("4389"),n("be51"),n("d9c7");var r=n("56ba"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[t.gameIsOver?n("div",{staticClass:"overlay__game-over"}):t._e(),n("div",{staticClass:"game-area"},[n("div",{class:{"player-health-container":!0,"player-health-container--won":t.gameWon,"player-health-container--lost":t.gameLost}},[n("span",{class:{"player-health":!0,"player-health--positive":t.playerHealthHistory.length>0&&t.playerHealthHistory[0].modifier>0&&t.playerHealthHistory[0].turn+t.scoreHistoryEffectTurns>=t.turns&&!t.gameWon,"player-health--negative":t.playerHealthHistory.length>0&&t.playerHealthHistory[0].modifier<0&&t.playerHealthHistory[0].turn+t.scoreHistoryEffectTurns>=t.turns&&!t.gameWon}},[t._v(" "+t._s(t.playerHealth)+" ")]),n("span",{class:{"player-health-total":!0}},[t._v(" "+t._s(" / "+t.healthGoal)+" ")])]),t._l(t.world,(function(e,r){return n("div",{key:r,staticClass:"row"},t._l(e,(function(e,a){return n("div",{key:a,staticClass:"cell",class:t.cellClasses(e,a,r)},[t._v(" "+t._s((t.isPlayerCell(a,r)?t.playerEmoji:"")+(t.isPlayerCell(a,r)?t.heldItems.map((function(t){return t.symbol()})).join(""):""))+" ")])})),0)})),""!==t.announcementMessage&&t.announcementTurn>t.turns-t.turnsToDisplayAnnouncements?n("div",{class:{"announcement-container":!0}},[n("p",[t._v(t._s(t.announcementMessage))])]):t._e()],2)])},i=[],o=(n("85e5"),n("6433"),n("3503"),n("df46"),n("3d9f"),n("3186"),n("2508"),n("4515"),n("8ac7")),s=n("e4e8"),h=n.n(s),l={sword:function(t){return{attack:function(e){var n=this;e.health-=2,this.health--,0===this.health&&(t.heldItems=t.heldItems.filter((function(t){return t!==n})),t.announce("Your üó°Ô∏è broke!"))},symbol:function(){return"üó°Ô∏è"},type:"sword",health:4}},pick:function(t){return{attack:function(e){var n=this;"dirt"===e.type||"wall"===e.type?e.health=0:e.health--,this.health--,0===this.health&&(t.heldItems=t.heldItems.filter((function(t){return t!==n})),t.announce("Your ‚õèÔ∏è broke!"))},symbol:function(){return"‚õèÔ∏è"},type:"pick",health:12}}},u={sword:function(t){return{damage:0,healthBonus:0,health:1,gameLimit:1,type:"sword",turnCreated:t.turns,onDestroy:function(e){t.heldItems.unshift(l.sword(t)),t.announce("Retrieved üó°Ô∏è. Damage is now doubled."),t.x=e.x,t.y=e.y}}},pick:function(t){return{damage:0,healthBonus:0,health:1,gameLimit:1,type:"pick",turnCreated:t.turns,onDestroy:function(e){t.heldItems.unshift(l.pick(t)),t.announce("Retrieved ‚õèÔ∏è. You can now dig through everything!"),t.x=e.x,t.y=e.y}}},chest:function(t){return{damage:0,healthBonus:0,health:1,gameLimit:1,type:"chest",turnCreated:t.turns,shouldCreate:function(){return 0===t.heldItems.length&&t.npcs.every((function(t){return"sword"!==t.type&&"pick"!==t.type}))},onDestroy:function(e){t.addNpc(Math.floor(2*Math.random())?"sword":"pick",{x:e.x,y:e.y})}}},fish:function(t){return{damage:0,healthBonus:10,health:1,gameLimit:10,type:"fish",turnCreated:t.turns,speed:8,movePattern:"fleeing",onDestroy:function(e){t.x=e.x,t.y=e.y}}},monster:function(t){return{damage:4,healthBonus:2,health:2,type:"monster",gameLimit:15,turnCreated:t.turns,speed:2,movePattern:"hostile"}},dirt:function(t){return{healthBonus:0,health:2,type:"dirt",turnCreated:t.turns,onDestroy:function(e){t.x=e.x,t.y=e.y}}},wall:function(t){return{health:Math.infinity,type:"wall",turnCreated:t.turns,onDestroy:function(e){t.x=e.x,t.y=e.y}}}},c={name:"App",data:function(){return{world:new Array(12).fill(1).map((function(){return new Array(12).fill(1).map((function(){return{npcs:[],items:[]}}))})),x:null,y:null,heldItems:[],playerHealth:50,healthGoal:100,npcs:[],items:[],turns:0,playerHealthHistory:[],announcementMessage:"",announcementTurn:0,initialMonsters:3,initialWallSections:10,initialDirtSections:15,playerHungerFactor:1,scoreHistoryEffectTurns:1,turnsToDisplayAnnouncements:2}},beforeDestroy:function(){this.teardownKeyPresses()},beforeMount:function(){var t=this.getRandomXY(0,0);this.x=t.x,this.y=t.y},mounted:function(){this.setupKeyPresses();for(var t=0;t<this.initialMonsters;t++)this.addNpc("monster");for(var e=0;e<this.initialWallSections;e++)this.addLineOfNpcs("wall");for(var n=0;n<this.initialDirtSections;n++)this.addLineOfNpcs("dirt");this.announce("Attack things with üòº using Arrowkeys/Spacebar (or Swipe/Doubletap). Hit the\n                    goal of ".concat(this.healthGoal,"!")),window.data=this.$data,window.comp=this},computed:{gameLost:function(){return 0===this.playerHealth},playerEmoji:function(){return 0===this.playerHealth?"üòø":this.playerHealth<5?"üôÄ":this.playerHealth<10?"üê±":this.playerHealth<15?"üòæ":this.playerHealth>=100?"üò∫":"üòº"},gameIsOver:function(){return this.gameLost||this.gameWon},gameWon:function(){return this.playerHealth>=this.healthGoal}},methods:{addLineOfNpcs:function(t){var e=this.getRandomXY(),n=0,r=0;0===Math.floor(2*Math.random())?n=Math.floor(2*Math.random())?1:-1:r=Math.floor(2*Math.random())?1:-1;for(var a=Math.floor(7*Math.random()),i=0;i<a;i++){var o=n*i,s=r*i;if(!this.withinGameArea(e.x+o,e.y+s)||!this.isFarAwayEnoughFromPlayer(e.x+o,e.y+s,1)||!this.isFarAwayEnoughFromNpcs(e.x+o,e.y+s,1))break;this.addNpc(t,{x:e.x+o,y:e.y+s})}},withinGameArea:function(t,e){var n;return!(null===(n=this.world[e])||void 0===n||!n[t])},announce:function(t){this.announcementMessage=t,this.announcementTurn=this.turns},setPlayerHealth:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t<0&&(t=0),t>this.healthGoal&&(t=this.healthGoal),e&&this.playerHealthHistory.unshift({modifier:t-this.playerHealth,turn:this.turns}),this.playerHealth=t},addNpc:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!u[t])throw new Error("Invalid NPC type: "+t);try{var n=Object(o["a"])(Object(o["a"])(Object(o["a"])({},this.getRandomXY()),u[t](this)),e);if(n.shouldCreate&&!n.shouldCreate()||n.gameLimit<=this.npcs.reduce((function(e,n){return n.type===t?e+1:e}),0))return;this.npcs.push(n),this.world[n.y][n.x].npcs.push(n)}catch(r){if("NO_VALID_POSITION"!==r.code)return;throw r}},setNpcPosition:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.x,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.y;this.world[t.y][t.x].npcs=this.world[t.y][t.x].npcs.filter((function(e){return e!==t})),this.world[n][e].npcs.push(t),t.x=e,t.y=n},isNth:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.turns,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e%t===n},advanceNpcs:function(){var t=this;this.npcs.forEach((function(e){var n=e.x,r=e.y;void 0!==e.movePattern&&void 0!==e.speed&&t.isNth(e.speed,t.turns-e.turnCreated)&&("hostile"===e.movePattern?t.x<e.x?n--:t.x>e.x?n++:t.y<e.y?r--:t.y>e.y&&r++:"fleeing"===e.movePattern&&(t.x<e.x?n++:t.x>e.x?n--:t.y<e.y?r++:t.y>e.y&&r--)),n=Math.min(Math.max(0,n),t.world[0].length-1),r=Math.min(Math.max(0,r),t.world.length-1),0!==t.world[r][n].npcs.length||n===t.x&&r===t.y||t.setNpcPosition(e,n,r),n===t.x&&r===t.y&&t.setPlayerHealth(t.playerHealth-e.damage)}))},advanceTurn:function(){this.gameIsOver||(this.isNth(1)&&this.setPlayerHealth(this.playerHealth-this.playerHungerFactor,!1),this.advanceNpcs(),this.isNth(5+Math.floor(this.turns/40))&&this.addNpc("monster"),this.isNth(Math.max(1,3-Math.floor(this.turns/40)))&&this.addNpc("fish"),this.isNth(0===Math.floor(3*Math.random()))&&this.addNpc("chest"),this.turns++)},teardownKeyPresses:function(){this.handlerFn&&(document.removeEventListener("keydown",this.handlerFn),this.mc.destroy())},setupKeyPresses:function(){var t=this;this.handlerFn||(this.handlerFn=function(e){if(!t.gameIsOver)switch(e.key){case"ArrowLeft":t.moveOrAttack("left"),t.advanceTurn();break;case"ArrowRight":t.moveOrAttack("right"),t.advanceTurn();break;case"ArrowUp":t.moveOrAttack("up"),t.advanceTurn();break;case"ArrowDown":t.moveOrAttack("down"),t.advanceTurn();break;case" ":t.advanceTurn();break}},this.mc=new h.a(this.$el),this.mc.get("swipe").set({direction:h.a.DIRECTION_ALL}),this.mc.on("swipeleft",(function(){t.handlerFn({key:"ArrowLeft"})})),this.mc.on("swiperight",(function(){t.handlerFn({key:"ArrowRight"})})),this.mc.on("swipeup",(function(){t.handlerFn({key:"ArrowUp"})})),this.mc.on("swipedown",(function(){t.handlerFn({key:"ArrowDown"})})),this.mc.on("doubletap",(function(){t.handlerFn({key:" "})})),document.addEventListener("keydown",this.handlerFn))},isPlayerCell:function(t,e){return t===this.x&&e===this.y},cellClasses:function(t,e,n){var r={"cell--player":e===this.x&&n===this.y,"cell--dead-player":e===this.x&&n===this.y&&this.gameLost},a=this.npcs.find((function(t){return t.x===e&&t.y===n}));return a&&(r["cell__npc-"+a.type]=!0,this.isNth(a.speed,this.turns-a.turnCreated)&&(r["cell__npc-"+a.type+"--moving"]=!0),a.health!==Math.infinity&&(r["cell__npc-"+a.type+"-health--"+a.health]=!0),a.x<this.x?r["cell__npc-"+a.type+"--left-of-player"]=!0:a.x>this.x&&(r["cell__npc-"+a.type+"--right-of-player"]=!0)),r},attackNpc:function(t){var e=this;t.npcs=t.npcs.filter((function(t){void 0!==t.healthBonus&&e.setPlayerHealth(e.playerHealth+t.healthBonus);var n=e.heldItems.find((function(t){return t.attack}));return n?n.attack(t):t.health-=1,!(t.health<=0)||(t.onDestroy&&t.onDestroy(t),e.npcs=e.npcs.filter((function(e){return t!==e})),!1)}))},moveOrAttack:function(t){var e,n=this.x,r=this.y;switch(t){case"up":r--;break;case"down":r++;break;case"left":n--;break;case"right":n++;break}var a=null===(e=this.world[r])||void 0===e?void 0:e[n];void 0!==a&&(0===a.npcs.length?(this.x=n,this.y=r):this.attackNpc(a))},isFarAwayEnoughFromPlayer:function(t,e,n){return t<=this.x-n||t>=this.x+n||e<=this.y-n||e>=this.y+n},isFarAwayEnoughFromNpcs:function(t,e,n){return this.npcs.every((function(r){return t<=r.x-n||t>=r.x+n||e<=r.y-n||e>=r.y+n}))},getRandomXY:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=function(){return{x:Math.floor(12*Math.random()),y:Math.floor(12*Math.random())}},a=50,i=0,o=0;do{t=r(),i++,i===a&&n>1&&(n--,o++,i=0),i===a&&e>1&&(e--,o++,i=0),(e>0&&!this.isFarAwayEnoughFromPlayer(t.x,t.y,e)||n>0&&!this.isFarAwayEnoughFromNpcs(t.x,t.y,n))&&(t=null)}while(!t&&i<a);if(t)return t;var s=new Error("Failed to generate a suitable position after "+i*(o+1)+" attempts (with "+o+" retries, lowering required distances from other things)");throw s.code="NO_VALID_POSITION",s}},components:{}},d=c,p=(n("5c0b"),n("bd92")),y=Object(p["a"])(d,a,i,!1,null,null,null),f=y.exports;r["a"].config.productionTip=!1,new r["a"]({render:function(t){return t(f)}}).$mount("#app")},"5c0b":function(t,e,n){"use strict";n("1937")}});
//# sourceMappingURL=app.62b8a422.js.map